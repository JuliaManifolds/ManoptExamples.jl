<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Minimizing the Acceleration of B√©zier Curves on the Sphere ¬∑ ManoptExamples.jl</title><meta name="title" content="Minimizing the Acceleration of B√©zier Curves on the Sphere ¬∑ ManoptExamples.jl"/><meta property="og:title" content="Minimizing the Acceleration of B√©zier Curves on the Sphere ¬∑ ManoptExamples.jl"/><meta property="twitter:title" content="Minimizing the Acceleration of B√©zier Curves on the Sphere ¬∑ ManoptExamples.jl"/><meta name="description" content="Documentation for ManoptExamples.jl."/><meta property="og:description" content="Documentation for ManoptExamples.jl."/><meta property="twitter:description" content="Documentation for ManoptExamples.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ManoptExamples.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../">Overview</a></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Difference of Convex</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../Difference-of-Convex-Benchmark/">A Benchmark</a></li><li><a class="tocitem" href="../Difference-of-Convex-Rosenbrock/">Rosenbrock Metric</a></li><li><a class="tocitem" href="../Difference-of-Convex-Frank-Wolfe/">Frank Wolfe comparison</a></li></ul></li><li><a class="tocitem" href="../HyperparameterOptimization/">Hyperparameter optimziation</a></li><li><a class="tocitem" href="../RayleighQuotient/">The Rayleigh Quotient</a></li><li><a class="tocitem" href="../Riemannian-mean/">Riemannian Mean</a></li><li><a class="tocitem" href="../Robust-PCA/">Robust PCA</a></li><li><a class="tocitem" href="../Rosenbrock/">Rosenbrock</a></li><li><a class="tocitem" href="../Total-Variation/">Total Variation</a></li></ul></li><li><a class="tocitem" href="../../objectives/">Objectives</a></li><li><a class="tocitem" href="../../data/">Data</a></li><li><a class="tocitem" href="../../contributing/">Contributing to ManoptExamples.jl</a></li><li><a class="tocitem" href="../../changelog/">Changelog</a></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Minimizing the Acceleration of B√©zier Curves on the Sphere</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Minimizing the Acceleration of B√©zier Curves on the Sphere</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaManifolds/ManoptExamples.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaManifolds/ManoptExamples.jl/blob/main/docs/src/examples/Bezier-curves.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Minimizing-the-Acceleration-of-B√©zier-Curves-on-the-Sphere"><a class="docs-heading-anchor" href="#Minimizing-the-Acceleration-of-B√©zier-Curves-on-the-Sphere">Minimizing the Acceleration of B√©zier Curves on the Sphere</a><a id="Minimizing-the-Acceleration-of-B√©zier-Curves-on-the-Sphere-1"></a><a class="docs-heading-anchor-permalink" href="#Minimizing-the-Acceleration-of-B√©zier-Curves-on-the-Sphere" title="Permalink"></a></h1><p>Ronny Bergmann 2023-06-06</p><pre><code class="language-julia hljs">using Manifolds, Manopt, ManoptExamples</code></pre><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p>B√©zier Curves can be generalized to manifolds by generalizing the <a href="https://en.wikipedia.org/wiki/De_Casteljau%27s_algorithm">de Casteljau algorithm üìñ</a> to work with geodesics instead of straight lines. An implementation in just a few lines as we demonstrated in [<a href="../../references/#AxenBaranBergmannRzecki:2023">ABBR23</a>] as</p><pre><code class="language-julia hljs">function bezier(M::AbstractManifold, t, pts::NTuple)
    p = bezier(M, t, pts[1:(end - 1)])
    q = bezier(M, t, pts[2:end])
    return shortest_geodesic(M, p, q, t)
end
function bezier(M::AbstractManifold, t, pts::NTuple{2})
    return shortest_geodesic(M, pts[1], pts[2], t)
end</code></pre><p>which is also available within this package as <a href="../../objectives/#ManoptExamples.de_Casteljau-Tuple{ManifoldsBase.AbstractManifold, Vararg{Any}}"><code>de_Casteljau</code></a> using a simple <a href="../../objectives/#ManoptExamples.BezierSegment"><code>BezierSegment</code></a> <code>struct</code> to make it easier to also discuss the case where we compose a set of segments into a composite B√©zier course.</p><p>In the following we will need the following packages and functions. They are documented in the section on <a href="../../objectives/#BezierCurves">Bezier Curves</a> and were derived in [<a href="../../references/#BergmannGousenbourger:2018">BG18</a>] based on [<a href="../../references/#PopielNoakes:2007">PN07</a>].</p><pre><code class="language-julia hljs">using ManoptExamples:
    artificial_S2_composite_Bezier_curve,
    BezierSegment,
    de_Casteljau,
    get_Bezier_degrees,
    get_Bezier_inner_points,
    get_Bezier_junctions,
    get_Bezier_junction_tangent_vectors,
    get_Bezier_points,
    get_Bezier_segments,
    grad_L2_acceleration_Bezier,
    L2_acceleration_Bezier</code></pre><p>This notebook reproduces the example form Section 5.2 in [<a href="../../references/#BergmannGousenbourger:2018">BG18</a>].</p><p>The following image illustrates how the de-Casteljau algorithm works for one segment.</p><p><img src="../img/bezier/Casteljau-illustr.png" alt="A Bezier segment and illustration of the de-Casteljau algorithm"/></p><h2 id="Approximating-data-by-a-curve-with-minimal-accelartion"><a class="docs-heading-anchor" href="#Approximating-data-by-a-curve-with-minimal-accelartion">Approximating data by a curve with minimal accelartion</a><a id="Approximating-data-by-a-curve-with-minimal-accelartion-1"></a><a class="docs-heading-anchor-permalink" href="#Approximating-data-by-a-curve-with-minimal-accelartion" title="Permalink"></a></h2><p>We first load our example data</p><pre><code class="language-julia hljs">M = Sphere(2)
B = artificial_S2_composite_Bezier_curve()
data_points = get_Bezier_junctions(M, B)</code></pre><p>Which is the following cure, which clearly starts and ends slower than its speed in the middle, which can be seen by the increasing length of the gangent vectors in the middle.</p><p><img src="../img/bezier/bezier-acceleration-orig.png" alt="The original curve"/></p><p>We continue to recude the points, since we ‚Äúknow‚Äù sme points due to the <span>$C^1$</span> property: the second to last control point of the first segment <span>$b_{0,2}$</span>, the joint junction point connecting both segments <span>$b_{0,3}=b_{1,0}$</span> and the second control point <span>$b_{1,1}$</span> of the second segment have to line in the tangent space of the joint junction point. Hence we only have to store one of the control points.</p><p>We can use this reduced form as the variable to optimize and the one from the data as our initial point.</p><pre><code class="language-julia hljs">pB = get_Bezier_points(M, B, :differentiable)
N = PowerManifold(M, NestedPowerRepresentation(), length(pB))</code></pre><pre><code class="nohighlight hljs">PowerManifold(Sphere(2, ‚Ñù), NestedPowerRepresentation(), 8)</code></pre><p>And we further define the acceleration of the curve as our cost function, where we discretize the acceleration at a certain set of points and set the <span>$Œª=10$</span></p><pre><code class="language-julia hljs">curve_samples = [range(0, 3; length=101)...] # sample curve for the gradient
Œª = 10.0
function f(M, pB)
    return L2_acceleration_Bezier(
        M.manifold, pB, get_Bezier_degrees(M.manifold, B), curve_samples, Œª, data_points
    )
end
function grad_f(M, pB)
    return grad_L2_acceleration_Bezier(
        M.manifold, pB, get_Bezier_degrees(M.manifold, B), curve_samples, Œª, data_points
    )
end</code></pre><pre><code class="nohighlight hljs">grad_f (generic function with 1 method)</code></pre><p>Then we can optimize</p><pre><code class="language-julia hljs">x0 = pB
pB_opt = gradient_descent(
    N,
    f,
    grad_f,
    x0;
    stepsize=ArmijoLinesearch(N;
        initial_stepsize=1.0,
        retraction_method=ExponentialRetraction(),
        contraction_factor=0.5,
        sufficient_decrease=0.001,
    ),
    stopping_criterion=StopWhenChangeLess(1e-5) |
                       StopWhenGradientNormLess(1e-7) |
                       StopAfterIteration(300),
    debug=[
        :Iteration,
        &quot; | &quot;,
        :Cost,
        &quot; | &quot;,
        DebugGradientNorm(),
        &quot; | &quot;,
        DebugStepsize(),
        &quot; | &quot;,
        :Change,
        &quot;\n&quot;,
        25,
        :Stop,
    ],
);</code></pre><pre><code class="nohighlight hljs">Initial  | f(x): 10.647244 |  |  | 
# 25     | f(x): 2.667564 | |grad f(p)|:0.890845571434862 | s:0.01326670131422904 | Last Change: 0.763281
# 50     | f(x): 2.650064 | |grad f(p)|:0.05536989605165708 | s:0.05306680525691616 | Last Change: 0.081780
# 75     | f(x): 2.649707 | |grad f(p)|:0.02135638585837997 | s:0.01326670131422904 | Last Change: 0.011590
# 100    | f(x): 2.649700 | |grad f(p)|:0.0012887575647752057 | s:0.05306680525691616 | Last Change: 0.001745
The algorithm performed a step with a change (2.9063044690733034e-7) less than 1.0e-5.</code></pre><p>And we can again look at the result</p><p>The result looks as</p><p><img src="../img/bezier/bezier-acceleration-result.png" alt="The resulting curve"/></p><p>where all control points are evenly spaced and we hence have less acceleration as the final cost compared to the initial one indicates. Note that the cost is not zero, since we always have a tradeoff between approximating the initial junctinons (data points) and minimizing the acceleration.</p><div class="citation noncanonical"><dl><dt>[ABBR23]</dt><dd><div>S.¬†D.¬†Axen, M.¬†Baran, R.¬†Bergmann and K.¬†Rzecki. <em>Manifolds.jl: An Extensible Julia Framework for Data Analysis on Manifolds</em>. <a href="https://doi.org/10.1145/3618296">ACM¬†Transactions¬†on¬†Mathematical¬†Software</a> (2023), <a href="https://arxiv.org/abs/2021.08777">arXiv:2021.08777</a>.</div></dd><dt>[BG18]</dt><dd><div>R.¬†Bergmann and P.-Y.¬†Gousenbourger. <em>A variational model for data fitting on manifolds by minimizing the acceleration of a B√©zier curve</em>. <a href="https://doi.org/10.3389/fams.2018.00059">Frontiers¬†in¬†Applied¬†Mathematics¬†and¬†Statistics <strong>4</strong></a> (2018), <a href="https://arxiv.org/abs/1807.10090">arXiv:1807.10090</a>.</div></dd><dt>[PN07]</dt><dd><div>T.¬†Popiel and L.¬†Noakes. <em>B√©zier curves and <span>$C^2$</span> interpolation in Riemannian manifolds</em>. <a href="https://doi.org/10.1016/j.jat.2007.03.002">Journal¬†of¬†Approximation¬†Theory <strong>148</strong>, 111‚Äì127</a> (2007).</div></dd></dl></div></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Friday 7 June 2024 21:59">Friday 7 June 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
